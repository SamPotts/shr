!function(t){"use strict";var d,i={data:{},ttl:0},u={facebook:{url:function(t){return"https://graph.facebook.com/?id="+t},shareCount:function(t){return t.share.share_count}},twitter:{url:function(t){return null},shareCount:function(t){return null}},google:{url:function(t){return null},shareCount:function(t){return null}},pinterest:{url:function(t){return"https://widgets.pinterest.com/v1/urls/count.json?url="+t},shareCount:function(t){return t.count}},github:{url:function(t,e){return"https://api.github.com/repos"+t+("string"==typeof e?"?access_token="+e:"")},shareCount:function(t){return t.data.stargazers_count}},youtube_subscribe:{url:function(t,e){return"https://www.googleapis.com/youtube/v3/channels?part=statistics&forUsername="+t+"&key="+e},shareCount:function(t){return null==t.error?t.items[0].statistics.subscriberCount:null}},storage:{enabled:function(){try{var t="___test";return window.localStorage.setItem(t,t),window.localStorage.removeItem(t),!0}catch(t){return!1}}()}},a={selector:"data-shr-network",count:{classname:"share-count",displayZero:!1,format:!0,position:"after",increment:!0,html:function(t,e,n){return'<span class="'+e+" "+e+"--"+n+'">'+t+"</span>"}},google:{popup:{width:500,height:500}},facebook:{popup:{width:640,height:270}},twitter:{popup:{width:640,height:240}},pinterest:{popup:{width:750,height:550}},github:{tokens:{}},youtube_subscribe:{channel:"",key:""},storage:{key:"shr",ttl:3e5}},c=function(){};function l(t){return null==t||!t.length}function n(t,e,n){t&&function t(e,n,o,r){var i=n.split(" ");if(e instanceof NodeList)for(var u=0;u<e.length;u++)e[u]instanceof Node&&t(e[u],n,o,r);else for(var a=0;a<i.length;a++)e[r?"addEventListener":"removeEventListener"](i[a],o,!1)}(t,e,n,!0)}function s(t,e){for(var n in e)e[n]&&e[n].constructor&&e[n].constructor===Object?(t[n]=t[n]||{},s(t[n],e[n])):t[n]=e[n];return t}function e(t,e){e=e.replace(/[[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(t);return null===n?"":decodeURIComponent(n[1].replace(/\+/g," "))}function w(t){switch(t.network){case"facebook":return e(t.link.search,"u");case"github":return t.link.pathname;case"twitter":case"pinterest":case"google":return e(t.link.search,"url");case"youtube_subscribe":return t.link.pathname;default:return e(t.link.search,"url")}}function o(n,o){var t=function(t){if(t.network in d)switch(t.network){case"github":return d[t.network].url(t.url,d.github.tokens);case"youtube_subscribe":return d[t.network].url(d.youtube_subscribe.channel,d.youtube_subscribe.key);default:return d[t.network].url(encodeURIComponent(t.url))}return null}(n);if(!l(t)&&d.storage.enabled){var r=w(n);if(r in i.data&&n.network in i.data[r]&&i.ttl>Date.now())return void o.call(null,i.data[r][n.network])}l(t)||function(t,e){var n="jsonp_callback_"+Math.round(1e5*Math.random());window[n]=function(t){delete window[n],document.body.removeChild(o),e(t)};var o=document.createElement("script");o.setAttribute("src",t+(0<=t.indexOf("?")?"&":"?")+"callback="+n),document.body.appendChild(o)}(t,function(t){var e;d.storage.enabled&&(r in i.data||(i.data[r]={}),i.data[r][n.network]=t,e=i.data,d.storage.enabled&&(window.localStorage[d.storage.key]=JSON.stringify(e),window.localStorage[d.storage.key+"_ttl"]=Date.now()+d.storage.ttl)),o.call(null,t)})}function h(t){return t=Number(t),isNaN(t)?0:t}function r(t,e,n){var o,r,i,u=0,a=t.link.getAttribute("data-shr-display");if(l(a)?t.network in d&&(u=d[t.network].shareCount(e)):u=e[a],u=h(u),t.count=u,n&&(t.display&&(u=h(t.display.innerText)),u++),0<u||d.count.displayZero){d.count.position=d.count.position.toLowerCase();var c,s="after"===d.count.position;c=d.count.format&&1e6<t.count?Math.round(u/1e6)+"M":d.count.format&&1e3<t.count?Math.round(u/1e3)+"K":(o=u,r=/\./.test(1.1.toLocaleString())?".":",",i=new RegExp("\\"+r+"\\d+$"),Math.round(o).toLocaleString().replace(i,"")),t.display?t.display.textContent=c:(t.link.insertAdjacentHTML(s?"afterend":"beforebegin",d.count.html(c,d.count.classname,d.count.position)),t.display=t.link[s?"nextSibling":"previousSibling"])}}function f(t){var e=this;return void 0===t?(c("No share link found."),!1):(e.link=t,e.network=t.getAttribute(d.selector),e.url=w(e),o(e,function(t){r(e,t)}),n(e.link,"click",function(t){!function(t,e){if(d[e.network].popup){t.preventDefault();var n=d[e.network].popup,o=e.link.href,r=n.width,i=n.height,u="window-"+e.network;if(window[u]&&!window[u].closed)window[u].focus();else{var a=void 0!==window.screenLeft?window.screenLeft:screen.left,c=void 0!==window.screenTop?window.screenTop:screen.top,s=screen.width/2-r/2+a,l=screen.height/2-i/2+c;window[u]=window.open(o,e.network,"top="+l+",left="+s+",width="+r+",height="+i),window[u].focus()}window[u].opener=null}}(t,e),o(e,function(t){r(e,t,d.count.increment)})}),e)}t.setup=function(t){d=s(d=s(a,t),u);var e=document.querySelectorAll("["+d.selector+"]");d.storage.enabled&&d.storage.key in window.localStorage&&(i={data:JSON.parse(window.localStorage[d.storage.key]),ttl:window.localStorage[d.storage.key+"_ttl"]});for(var n=e.length-1;0<=n;n--){var o=e[n];if(void 0===o.shr){var r=new f(o);o.shr=!!Object.keys(r).length&&r}}d.debug&&window.console&&(window.console.log.bind(console),c=window.console.error.bind(console))}}(window.shr=window.shr||{});
